---
layout: article-custom
title: "A First PWA"
date: 2017-10-05
stylesheet: first-pwa
permalink: /articles/first-pwa
meta:
  description: Notes a making my first progressive web app
  image: /articles/assets/post-image-limbo-social.png
---

<p class="entry-intro">

</p>

switch over to HTTPS,
add a JSON manifest file with your metacrap, and
add a service worker.

<blockquote>
  <p>
    That last step can be tricky if you’re new to service workers...
  </p>
</blockquote>

## Adding a Manifest

- Create manifest.json in root public directory. The same directory has favicon and index.html. In this case <code>/public</code>
- Add <code>short_name</code> and <code>name</code>
- Referenced manifest in index.html <code>link rel="manifest" href="/manifest.json"</code>
- Created and added three launch icon sizes. At least one (192x192) is required.
- Add colors: background_color and theme_color
- Add display: standalone
- Added <code>noscript</code> content. Would be better to have some type of useful experience without JS, but will try that another time. It's interesting to think how to make a site like this provide something of value without JS.
- Noticed I was still failing the Splash Screen audit so added more icon sizes; 256x256, 384x384, and 512x512. I'm not sure what each of those are for, but they were recomended.

Oh:
> If you want to manually verify that your web app manifest is set up correctly, use the Manifest tab on the Application panel of Chrome DevTools.

I didn't realize that was a thing. Kept re-running the PWA Audit. It's great and has an "Add to homescreen" button to test the mechanism which is much appreciated since I don't have access to an Android device.

At this point I still don’t have an PWA that can be added to any homescreen. The audit turns up one failure still:
> Failures: Site does not register a Service Worker, Manifest start_url is not cached by a Service Worker.

## The Service Worker

This was the biggest mystery for me. I understood the concept of service workers. I didn't understand what the goals of a service worker for a PWA were. Sure, it's JS, it runs in the background, but what’s the JS supposed to do?

Steps:
- Following the tutorial, register the most simple service worker possible. Does nothing.
- Got hung up when listing assets to cache because my JS/CSS files are fingerprinted. This is default in create-react-app. I don't want to eject to change things. Researching what to do...


Thoughts:
- I didn't know Service Workers usurped AppCache, which was an awful thing
- This feels a bit like reading about Responsive Design for the first time
- <code>caches</code> is a global variable. On <code>window</code> scope.
- Usually, when I thought my service working wasn't updating correctly, it wasn't that, it was cache at Cloudfront.


#### Reference:
- https://developers.google.com/web/fundamentals/web-app-manifest/
- https://developer.mozilla.org/en-US/docs/Web/Manifest
- https://developers.google.com/web/tools/lighthouse/audits/registered-service-worker
- (most helpful, but dated) https://codelabs.developers.google.com/codelabs/offline
- https://jakearchibald.com/2014/offline-cookbook/

TODO:
- Add google analytics
